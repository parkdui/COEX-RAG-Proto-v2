# 30자 내외 응답을 위한 maxTokens 계산

## 📊 토큰 계산 기준

### 한글 토큰화 특성
- **한글 1자**: 약 1.3 ~ 1.5 tokens
- **영어 1단어**: 약 1.3 tokens
- **숫자/기호**: 약 1 token

### 30자 내외 응답 계산

#### 기본 계산
- 30자 × 1.5 tokens/자 = **45 tokens**

#### 안전 마진 포함
- 기본: 45 tokens
- 여유 20%: 54 tokens
- 안전 마진: **60-70 tokens**

#### 실제 테스트 결과 (예상)
- 30자 응답: 약 40-50 tokens
- 안전하게 설정: **60-80 tokens**

---

## 🎯 권장 maxTokens 설정

### 최소값 (30자 정확히)
```typescript
maxTokens: 50  // 30자 × 1.5 + 여유 5
```

### 권장값 (30자 내외, 안전)
```typescript
maxTokens: 70  // 30자 × 1.5 + 여유 25 (안전 마진)
```

### 최대값 (30자 초과 방지)
```typescript
maxTokens: 80  // 30자 × 1.5 + 여유 35 (절대 초과 방지)
```

---

## 📝 System Prompt 수정 필요

현재 system prompt에 "최대 200자"라고 되어 있으므로, 30자로 변경 필요:

```typescript
// 현재
"반드시 200자 이내로만 답하세요."

// 변경 후
"반드시 30자 이내로만 답하세요."
```

---

## ✅ 최종 권장 설정

```typescript
maxTokens: 70  // 30자 내외 응답을 위한 안전한 값
```

**이유:**
- 30자 × 1.5 = 45 tokens
- 여유 25 tokens (55% 여유)
- 응답이 30자를 약간 초과해도 안전
- 너무 짧게 잘리는 것 방지

---

## 🧪 테스트 방법

실제로 테스트해보면서 조정:
1. `maxTokens: 50` → 너무 짧을 수 있음
2. `maxTokens: 70` → 권장 (안전)
3. `maxTokens: 80` → 최대값 (30자 초과 가능)

---

## 💡 참고사항

- **maxTokens는 최대값**: 실제로는 더 짧게 나올 수 있음
- **System Prompt가 중요**: "30자 이내" 명시가 필수
- **실제 테스트 필요**: 모델마다 토큰화 방식이 다를 수 있음





